<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Masonry Grid with Categories</title>
    <style>
      body {
        font-family: Arial, Helvetica, sans-serif;
      }
      .masonry-grid {
        float:left;
        width:86%;
        column-count: 6;
        column-gap: 10px;
      }

      .grid-item {
        break-inside: avoid;
        margin-bottom: 10px;
        position: relative;
      }

      .grid-item img {
        width: 100%;
        display: block;
      }

      .checkbox {
        float:left;
        width:13%;
      }
      .category-checkbox {
        margin-right: 10px;
      }

      .hidden {
        display: none;
      }

      .grid-item h3 {
        font-size: 18px;
        margin: 3px 0; /* Ridotto il margine tra il titolo e il paragrafo */
        color: #333;
      }

      /* Stili per il paragrafo (p) */
      .grid-item p {
        font-size: 14px;
        color: #666;
        margin: 3px 0; /* Ridotto il margine tra il titolo e il paragrafo */
      }

      .grid-item h3:hover {
        animation: rainbow 2.5s linear;
        animation-iteration-count: infinite;
      }

      @keyframes rainbow {
        100%,
        0% {
          color: rgb(255, 0, 0);
        }
        8% {
          color: rgb(255, 127, 0);
        }
        16% {
          color: rgb(255, 255, 0);
        }
        25% {
          color: rgb(127, 255, 0);
        }
        33% {
          color: rgb(0, 255, 0);
        }
        41% {
          color: rgb(0, 255, 127);
        }
        50% {
          color: rgb(0, 255, 255);
        }
        58% {
          color: rgb(0, 127, 255);
        }
        66% {
          color: rgb(0, 0, 255);
        }
        75% {
          color: rgb(127, 0, 255);
        }
        83% {
          color: rgb(255, 0, 255);
        }
        91% {
          color: rgb(255, 0, 127);
        }
      }

      .slideshow-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        z-index: 9999;
        display: none;
      }

      .mySlides {
        display: none;
      }

      .prev,
      .next {
        cursor: pointer;
        position: absolute;
        top: 50%;
        width: auto;
        margin-top: -22px;
        padding: 16px;
        color: white;
        font-weight: bold;
        font-size: 18px;
        transition: 0.6s ease;
        border-radius: 0 3px 3px 0;
        user-select: none;
      }

      .next {
        right: 0;
        border-radius: 3px 0 0 3px;
      }

      .prev:hover,
      .next:hover {
        background-color: rgba(0, 0, 0, 0.8);
      }
    </style>
  </head>
  <body>
    <div class="checkbox">
      <label class="category-checkbox"
        ><input type="checkbox" id="category1" /> Category 1</label
      >
      <label class="category-checkbox"
        ><input type="checkbox" id="category2" /> Category 2</label
      >
      <label class="category-checkbox"
        ><input type="checkbox" id="category3" /> Category 3</label
      >
      <label class="category-checkbox"
        ><input type="checkbox" id="category4" /> Category 4</label
      >
      <!-- Aggiungi altri checkbox per le categorie qui -->
    </div>

    <div class="masonry-grid" id="imageGrid"></div>

    <script type="module" src="https://cdn.skypack.dev/masonry-layout"></script>
    <script type="module">
      // Dati delle immagini con categorie, titolo e paragrafo
      function showSlideshow(imageId) {
        const overlay = document.getElementById(`slideshow-${imageId}`);
        overlay.style.display = "flex"; // or "block" based on your styling preference
      }

      function closeSlideshow(imageId) {
          const overlay = document.getElementById(`slideshow-${imageId}`);
          overlay.style.display = "none";
        }

      function createSlideshow(slideshowContainer, images) {
        let slideIndex = 0;

        function showSlides(index) {
          const slides = slideshowContainer.getElementsByClassName("mySlides");
          if (index >= slides.length) {
            slideIndex = 0;
          } else if (index < 0) {
            slideIndex = slides.length - 1;
          } else {
            slideIndex = index;
          }

          for (let i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
          }

          slides[slideIndex].style.display = "block";
        }


        function plusSlides(n) {
          showSlides(slideIndex + n);
        }

        const prevButton = slideshowContainer.getElementsByClassName("prev")[0];
        const nextButton = slideshowContainer.getElementsByClassName("next")[0];

        prevButton.addEventListener("click", () => plusSlides(-1));
        nextButton.addEventListener("click", () => plusSlides(1));

        showSlides(slideIndex);        

      }

      const imageArray = [
        {
          id: 1,
          src: "assets/img (1).jpg",
          category: ["category1", "category2"],
          title: "Title 1",
          paragraph: "Lorem ipsum 1",
          slideshowImages: [
            "assets/img (11).jpg",
            "assets/img (12).jpg",
            "assets/img (13).jpg",
          ],
        },
        {
          id: 2,
          src: "assets/img (2).jpg",
          category: ["category2", "category3"],
          title: "Title 2",
          paragraph: "Lorem ipsum 2",
          slideshowImages: [
            "assets/img (14).jpg",
            "assets/img (15).jpg",
            "assets/img (16).jpg",
          ],
        },
        {
          id: 3,
          src: "assets/img (3).jpg",
          category: ["category3", "category4"],
          title: "Title 3",
          paragraph: "Lorem ipsum 3",
          slideshowImages: [
            "assets/img (17).jpg",
            "assets/img (18).jpg",
            "assets/img (19).jpg",
          ],
        },
        {
          id: 4,
          src: "assets/img (4).jpg",
          category: ["category4", "category1"],
          title: "Title 4",
          paragraph: "Lorem ipsum 4",
          slideshowImages: [
            "assets/img (20).jpg",
            "assets/img (21).jpg",
            "assets/img (22).jpg",
          ],
        },
      ];

      document.addEventListener("DOMContentLoaded", function () {
        const imageGrid = document.getElementById("imageGrid");
        const checkboxes = document.querySelectorAll(
          ".category-checkbox input"
        );

        function updateGrid() {
          const selectedCategories = Array.from(checkboxes)
            .filter((checkbox) => checkbox.checked)
            .map((checkbox) => checkbox.id);

          imageArray.forEach((image) => {
            const gridItem = document.getElementById(`image-${image.id}`);

            if (
              selectedCategories.length === 0 ||
              selectedCategories.every((category) =>
                image.category.includes(category)
              )
            ) {
              gridItem.classList.remove("hidden");
            } else {
              gridItem.classList.add("hidden");
            }
          });

          new Masonry(".masonry-grid", {
            itemSelector: ".grid-item:not(.hidden)",
            columnWidth: ".grid-item:not(.hidden)",
            gutter: 10,
          });
        }

        const gridMarkup = imageArray
          .map(
            (image) =>
              `<div class="grid-item" id="image-${
                image.id
              }" data-categories="${image.category.join(" ")}">
        <div class="slideshow-container" id="slideshow-${image.id}">
          ${image.slideshowImages
            .map(
              (slideshowImage, index) =>
                `<div class="mySlides">
                    <img src="${slideshowImage}" style="width:100%">
                  </div>`
            )
            .join("")}
          <a class="prev">&#10094;</a>
          <a class="next">&#10095;</a>
          <a class="close" onclick="closeSlideshow(${
            image.id
          })">&times;</a>
        </div>
        <img src="${image.src}" alt="Image" onclick="showSlideshow(${
                image.id
              })">
        <h3>${image.title}</h3>
        <p>${image.paragraph}</p>
      </div>`
          )
          .join("");

        imageGrid.innerHTML = gridMarkup;

        checkboxes.forEach((checkbox) =>
          checkbox.addEventListener("change", updateGrid)
        );

        imageArray.forEach((image) => {
          const slideshowContainer = document.getElementById(
            `slideshow-${image.id}`
          );
          createSlideshow(slideshowContainer, image.slideshowImages);
        });
        window.showSlideshow = showSlideshow; // Make showSlideshow global
        window.closeSlideshow = closeSlideshow; // Rendi la funzione closeSlideshow globale

        updateGrid();
      });
    </script>
  </body>
</html>